>[!quote] NIST 800-83
>"A **program** that is inserted into a system, usually covertly, with the intent of **compromising the confidentiality, integrity, or availability** of the victim’s data, applications, or operating system or otherwise annoying or disrupting the victim."

## classification of malware
Malware is usually classified based on two main factors:
- **how it spreads** to reach the desired targets
- the **actions** or payloads it performs once a target is reached

But it can also be classified by its **independence** and **replication ability**

| classified as       | description                                                                | example              |
| :------------------ | :------------------------------------------------------------------------- | :------------------- |
| **needs a host**    | parasitic code that **requires another legitimate program** to attach to   | viruses              |
| **independent**     | self-contained programs that can **run on their own**                      | worms, trojans, bots |
| **non-replicating** | malware that **does not create copies** of itself or spread automatically. | trojans, spam e-mail |
| **replicating**     | malware that **self-replicates** and spreads to other systems.             | viruses, worms       |

**Propagation mechanisms** include:
- *infection of existing content* by viruses that is subsequently spread to other systems
- *exploitation of software vulnerabilities* by worms or drive-by-downloads (unintended download of software) to allow the malware to replicate
- *social engineering* attacks that convince users to bypass mechanisms to install trojans or to respond to phishing attacks

**Payload actions** performed by malware once it reaches the target include:
- *corruption* of system or data files
- *theft of service* (or making the system a zombie agent as part of a botnet)
- *theft of information*
- hiding its presence in the system

> [!tip] attack kits
> Initially, the development and deployment of malware required considerable technical skill - the development of so-called "toolkits" (or "crimeware") aided even novices in deploying some mechanisms. Variants that can be built from these toolkits can generate a significant problem for those defending systems against them.

## Advanced Persistent Threats (APTs)
APTs are well-resourced, **persistent applications** of a wide variety of intrusion technologies and malware to **carefully-selected targets**.
- typically attributed to state-sponsored organisations or criminal entreprises

These attacks are advanced (wide variety of intrusion technologies, including custom malware), persistent (carried on over an extended period of time, potentially escalating), and, since there are capable, organised people behind them, they are more dangerous than simple automated attacks.

- **aim** ⟶ from theft of intellectual property or security and infrastructure related data to the physical disruption of infrastructure
- **techniques** ⟶ social engineering, spear-phishing (targeted phishing), drive-by downloads from selected compromised websites likely to be visited by personnel targets
- **intent** ⟶to gain access to systems in the target organization, and then to mantain and extend it with a further range of attack tools

## viruses
Viruses are pieces of software that **infect programs**.
They usually modify programs to include a copy of the virus, replicate and infect other content, and are easily spread through networks.
- when attached to an executable program, a virus can do *anything that the program is permitted to do*

The main **components** of a virus are:
- **infection mechanism**/vector ⟶ means by which a virus spreads
- **trigger**/logic bomb ⟶ condition that determines when the payload is activated or delivered
- **payload** ⟶ what the virus does

The phases of a virus's lifespan are:

| phase                 | description                                                                                  | characteristics                                          | more                                                                                                    |
| :-------------------- | :------------------------------------------------------------------------------------------- | :------------------------------------------------------- | :------------------------------------------------------------------------------------------------------ |
| **dormant phase**     | virus is *idle*                                                                              | will eventually be activated by some event               | not all viruses have this stage                                                                         |
| **triggering phase**  | virus is *activated* to perform the function for which it was intended                       | can be caused by a variety of system events              | -                                                                                                       |
| **propagation phase** | virus places a *copy* of itself into other programs or into certain system areas on the disk | the copy may not be identical to the propagating version | each infected program will now contain a clone of the virus which will itself enter a propagation phase |
| **execution phase**   | *function* is performed                                                                      | may be harmless or damaging                              | -                                                                                                       |
### macro and scripting viruses

>[!quote] NISTIR 7298
> A **macro virus** is defined as "a virus that attaches itself to documents and uses the macro programming capabilities of the document’s application to execute and propagate."

- macro viruses infect *scripting code* used to support active content in many types of user documents

Macro viruses are threatening because:
- they are **platform-independent**
- they infect **documents**, not executable portions of code
- they are **easily spread**
- traditional file systems access controls are of **limited use in preventing** their spread, since users are expected to modify documents
- they are **much easier to write** or modify than traditional executable viruses

### virus classification
**by target**:

| classification           | target description                                                                              |
| :----------------------- | :---------------------------------------------------------------------------------------------- |
| **boot sector infector** | infects a *boot record* and spreads when a system is booted from the disk containing the virus. |
| **file infector**        | infects *files* that the operating system or shell considers to be executable.                  |
| **macro virus**          | infects *files with macro or scripting code* that is interpreted by an application.             |
| **multipartite virus**   | infects *files in multiple ways*.                                                               |
**by concealment strategy**:

| classification        | concealment strategy description                                                                                       |
| :-------------------- | :--------------------------------------------------------------------------------------------------------------------- |
| **encrypted virus**   | a portion of the virus creates a *random encryption key* and encrypts the remainder of the virus.                      |
| **stealth virus**     | a form of virus explicitly *designed to hide itself* from detection by anti-virus software.                            |
| **polymorphic virus** | a virus that *mutates* with every infection.                                                                           |
| **metamorphic virus** | a virus that *mutates and rewrites itself* completely at each iteration and may change behavior as well as appearance. |

## worms
Worms are programs that **actively seek out more machines to infect**. Each infected machine serves as an automated launching pad for attacks on other machines.

Worms:
- exploit software vulnerabilities in client or server programs
- can use network connections and shared media to spread from system to system

### worm replication

| strategy                                          | description                                                                                                   |
| :------------------------------------------------ | :------------------------------------------------------------------------------------------------------------ |
| **electronic mail or instant messenger facility** | worm *e-mails a copy of itself* (/sends itself as an attachment) to other systems                             |
| **file sharing**                                  | worm creates a copy of itself or *infects a file* as a virus on removable media                               |
| **remote execution capability**                   | worm *executes a copy of itself* on another system                                                            |
| **remote file access or transfer capability**     | worm uses a *remote file access* or transfer service to copy itself from one system to the other              |
| **remote login capability**                       | worm *logs onto a remote system* as a user and then uses commands to copy itself from one system to the other |

### target discovery
